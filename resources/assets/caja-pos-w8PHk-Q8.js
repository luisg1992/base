import{ab as Ue,ac as _e,aA as Qe,b4 as We,af as Je,e as s,ar as Xe,as as Ye,aJ as Ze,av as qe,aQ as lt,r as g,a2 as R,h,aR as at,aU as Ee,b1 as nt,am as et,aC as re,ad as ke,an as tt,w as ie,y as te,ag as ot,b5 as Le,aM as Ve,b6 as st,F as H,a4 as De,b7 as it,b8 as ut,b9 as Me,B as de,ba as rt,bb as Oe,bc as ct,k as j,o as D,c as le,t as ze,bd as dt,l as fe,d as k,G as ft,n as Ke,g as Ne,D as vt,be as mt,bf as ht,bg as pt,ap as gt,bh as xt,al as yt,a3 as bt,aG as kt,at as Vt,bi as _t,au as Ct,aI as St,bj as wt,aw as Pt,bk as At,a9 as ae,b3 as Ft,v as n,aa as xe,C as E,bl as $e}from"./main-9HgRyXC8.js";import{u as It,V as je,m as Tt,a as Et}from"./VTextField-PUVURDPZ.js";import{u as Dt,m as Mt,a as zt}from"./VSelect-Ci_N5NKG.js";import{f as Ut}from"./forwardRefs-DWGaNmQL.js";import{u as Bt,V as Rt,a as He}from"./VList-DeehM45z.js";import{m as Lt}from"./VImg-CZY_P4Fm.js";import{V as Ot}from"./VMenu-DQJz5cCi.js";import{V as Kt}from"./VCheckboxBtn-BXZHxxTF.js";import{V as Nt,c as $t}from"./VAvatar-Ps3REWwh.js";import{V as jt}from"./VChip-CMwJqKEl.js";import{_ as Ht}from"./AppTextField-Bz7jAMe_.js";import{a as Ge}from"./index-DW_MHI2K.js";import{V as Gt}from"./VDialog-BK6oviDj.js";import{V as Ie}from"./VCard-BRfM9m0D.js";import{V as Te}from"./VCardText-CporWQ85.js";import{V as ye,a as ee}from"./VRow-WFl2eZwY.js";import{V as ce}from"./VCheckbox-BUHyZdeF.js";const Qt=_e({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...qe(),...Ze(),...Ye(),...Xe()},"VTable"),be=Ue()({name:"VTable",props:Qt(),setup(e,x){let{slots:a,emit:r}=x;const{themeClasses:p}=Qe(e),{densityClasses:V}=We(e);return Je(()=>s(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom,"v-table--hover":e.hover},p.value,V.value,e.class],style:e.style},{default:()=>{var _,M,w;return[(_=a.top)==null?void 0:_.call(a),a.default?s("div",{class:"v-table__wrapper",style:{height:lt(e.height)}},[s("table",null,[a.default()])]):(M=a.wrapper)==null?void 0:M.call(a),(w=a.bottom)==null?void 0:w.call(a)]}})),{}}}),Wt=(e,x,a)=>e==null||x==null?-1:e.toString().toLocaleLowerCase().indexOf(x.toString().toLocaleLowerCase()),Jt=_e({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function Xt(e,x,a){var M;const r=[],p=(a==null?void 0:a.default)??Wt,V=a!=null&&a.filterKeys?Ee(a.filterKeys):!1,_=Object.keys((a==null?void 0:a.customKeyFilter)??{}).length;if(!(e!=null&&e.length))return r;e:for(let w=0;w<e.length;w++){const[P,$=P]=Ee(e[w]),d={},m={};let A=-1;if((x||_>0)&&!(a!=null&&a.noFilter)){if(typeof P=="object"){const O=V||Object.keys($);for(const f of O){const G=nt($,f),L=(M=a==null?void 0:a.customKeyFilter)==null?void 0:M[f];if(A=L?L(G,x,P):p(G,x,P),A!==-1&&A!==!1)L?d[f]=A:m[f]=A;else if((a==null?void 0:a.filterMode)==="every")continue e}}else A=p(P,x,P),A!==-1&&A!==!1&&(m.title=A);const U=Object.keys(m).length,S=Object.keys(d).length;if(!U&&!S||(a==null?void 0:a.filterMode)==="union"&&S!==_&&!U||(a==null?void 0:a.filterMode)==="intersection"&&(S!==_||!U))continue}r.push({index:w,matches:{...m,...d}})}return r}function Yt(e,x,a,r){const p=g([]),V=g(new Map),_=R(()=>r!=null&&r.transform?h(x).map(w=>[w,r.transform(w)]):h(x));at(()=>{const w=typeof a=="function"?a():h(a),P=typeof w!="string"&&typeof w!="number"?"":String(w),$=Xt(_.value,P,{customKeyFilter:{...e.customKeyFilter,...h(r==null?void 0:r.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),d=h(x),m=[],A=new Map;$.forEach(U=>{let{index:S,matches:O}=U;const f=d[S];m.push(f),A.set(f.value,O)}),p.value=m,V.value=A});function M(w){return V.value.get(w.value)}return{filteredItems:p,filteredMatches:V,getMatches:M}}function Zt(e,x,a){if(x==null)return e;if(Array.isArray(x))throw new Error("Multiple matches is not implemented");return typeof x=="number"&&~x?s(H,null,[s("span",{class:"v-autocomplete__unmask"},[e.substr(0,x)]),s("span",{class:"v-autocomplete__mask"},[e.substr(x,a)]),s("span",{class:"v-autocomplete__unmask"},[e.substr(x+a)])]):e}const qt=_e({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Jt({filterKeys:["title"]}),...Mt(),...ot(Tt({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Lt({transition:!1})},"VAutocomplete"),el=Ue()({name:"VAutocomplete",props:qt(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,x){let{slots:a}=x;const{t:r}=et(),p=g(),V=re(!1),_=re(!0),M=re(!1),w=g(),P=g(),$=ke(e,"menu"),d=R({get:()=>$.value,set:l=>{var c;$.value&&!l&&((c=w.value)!=null&&c.ΨopenChildren.size)||($.value=l)}}),m=re(-1),A=R(()=>{var l;return(l=p.value)==null?void 0:l.color}),U=R(()=>d.value?e.closeText:e.openText),{items:S,transformIn:O,transformOut:f}=Bt(e),{textColorClasses:G,textColorStyles:L}=tt(A),C=ke(e,"search",""),v=ke(e,"modelValue",[],l=>O(l===null?[null]:Ee(l)),l=>{const c=f(l);return e.multiple?c:c[0]??null}),ne=R(()=>typeof e.counterValue=="function"?e.counterValue(v.value):typeof e.counterValue=="number"?e.counterValue:v.value.length),Q=It(e),{filteredItems:W,getMatches:oe}=Yt(e,S,()=>_.value?"":C.value),z=R(()=>e.hideSelected?W.value.filter(l=>!v.value.some(c=>c.value===l.value)):W.value),se=R(()=>!!(e.chips||a.chip)),J=R(()=>se.value||!!a.selection),Ce=R(()=>v.value.map(l=>l.props.value)),Y=R(()=>{var c;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&C.value===((c=z.value[0])==null?void 0:c.title))&&z.value.length>0&&!_.value&&!M.value}),ue=R(()=>e.hideNoData&&!z.value.length||Q.isReadonly.value||Q.isDisabled.value),Z=g(),Se=Dt(Z,p);function we(l){e.openOnClear&&(d.value=!0),C.value=""}function ve(){ue.value||(d.value=!0)}function X(l){ue.value||(V.value&&(l.preventDefault(),l.stopPropagation()),d.value=!d.value)}function me(l){var c;rt(l)&&((c=p.value)==null||c.focus())}function Pe(l){var y,F,K;if(Q.isReadonly.value)return;const c=p.value.selectionStart,I=v.value.length;if((m.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(d.value=!0),["Escape"].includes(l.key)&&(d.value=!1),Y.value&&["Enter","Tab"].includes(l.key)&&!v.value.some(T=>{let{value:B}=T;return B===z.value[0].value})&&i(z.value[0]),l.key==="ArrowDown"&&Y.value&&((y=Z.value)==null||y.focus("next")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&J.value&&v.value.length>0&&!C.value)return i(v.value[0],!1);if(~m.value){const T=m.value;i(v.value[m.value],!1),m.value=T>=I-1?I-2:T}else l.key==="Backspace"&&!C.value&&(m.value=I-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(m.value<0&&c>0)return;const T=m.value>-1?m.value-1:I-1;v.value[T]?m.value=T:(m.value=-1,p.value.setSelectionRange((F=C.value)==null?void 0:F.length,(K=C.value)==null?void 0:K.length))}if(l.key==="ArrowRight"){if(m.value<0)return;const T=m.value+1;v.value[T]?m.value=T:(m.value=-1,p.value.setSelectionRange(0,0))}}}function Ae(l){if(Le(p.value,":autofill")||Le(p.value,":-webkit-autofill")){const c=S.value.find(I=>I.title===l.target.value);c&&i(c)}}function Fe(){var l;e.eager&&((l=P.value)==null||l.calculateVisibleItems())}function he(){var l;V.value&&(_.value=!0,(l=p.value)==null||l.focus())}function o(l){V.value=!0,setTimeout(()=>{M.value=!0})}function t(l){M.value=!1}function u(l){(l==null||l===""&&!e.multiple&&!J.value)&&(v.value=[])}const b=re(!1);function i(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const I=v.value.findIndex(F=>e.valueComparator(F.value,l.value)),y=c??!~I;if(~I){const F=y?[...v.value,l]:[...v.value];F.splice(I,1),v.value=F}else y&&(v.value=[...v.value,l]);e.clearOnSelect&&(C.value="")}else{const I=c!==!1;v.value=I?[l]:[],C.value=I&&!J.value?l.title:"",Ve(()=>{d.value=!1,_.value=!0})}}return ie(V,(l,c)=>{var I;l!==c&&(l?(b.value=!0,C.value=e.multiple||J.value?"":String(((I=v.value.at(-1))==null?void 0:I.props.title)??""),_.value=!0,Ve(()=>b.value=!1)):(!e.multiple&&C.value==null&&(v.value=[]),d.value=!1,v.value.some(y=>{let{title:F}=y;return F===C.value})||(C.value=""),m.value=-1))}),ie(C,l=>{!V.value||b.value||(l&&(d.value=!0),_.value=!l)}),ie(d,()=>{if(!e.hideSelected&&d.value&&v.value.length){const l=z.value.findIndex(c=>v.value.some(I=>c.value===I.value));st&&window.requestAnimationFrame(()=>{var c;l>=0&&((c=P.value)==null||c.scrollToIndex(l))})}}),ie(()=>e.items,(l,c)=>{d.value||V.value&&!c.length&&l.length&&(d.value=!0)}),Je(()=>{const l=!!(!e.hideNoData||z.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),c=v.value.length>0,I=je.filterProps(e);return s(je,te({ref:p},I,{modelValue:C.value,"onUpdate:modelValue":[y=>C.value=y,u],focused:V.value,"onUpdate:focused":y=>V.value=y,validationValue:v.externalValue,counterValue:ne.value,dirty:c,onChange:Ae,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":d.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!J.value,"v-autocomplete--selecting-index":m.value>-1},e.class],style:e.style,readonly:Q.isReadonly.value,placeholder:c?void 0:e.placeholder,"onClick:clear":we,"onMousedown:control":ve,onKeydown:Pe}),{...a,default:()=>s(H,null,[s(Ot,te({ref:w,modelValue:d.value,"onUpdate:modelValue":y=>d.value=y,activator:"parent",contentClass:"v-autocomplete__content",disabled:ue.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Fe,onAfterLeave:he},e.menuProps),{default:()=>[l&&s(Rt,te({ref:Z,selected:Ce.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:y=>y.preventDefault(),onKeydown:me,onFocusin:o,onFocusout:t,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},Se,e.listProps),{default:()=>{var y,F,K;return[(y=a["prepend-item"])==null?void 0:y.call(a),!z.value.length&&!e.hideNoData&&(((F=a["no-data"])==null?void 0:F.call(a))??s(He,{title:r(e.noDataText)},null)),s(zt,{ref:P,renderless:!0,items:z.value},{default:T=>{var Re;let{item:B,index:q,itemRef:N}=T;const Be=te(B.props,{ref:N,key:q,active:Y.value&&q===0?!0:void 0,onClick:()=>i(B,null)});return((Re=a.item)==null?void 0:Re.call(a,{item:B,index:q,props:Be}))??s(He,te(Be,{role:"option"}),{prepend:pe=>{let{isSelected:ge}=pe;return s(H,null,[e.multiple&&!e.hideSelected?s(Kt,{key:B.value,modelValue:ge,ripple:!1,tabindex:"-1"},null):void 0,B.props.prependAvatar&&s(Nt,{image:B.props.prependAvatar},null),B.props.prependIcon&&s(De,{icon:B.props.prependIcon},null)])},title:()=>{var pe,ge;return _.value?B.title:Zt(B.title,(pe=oe(B))==null?void 0:pe.title,((ge=C.value)==null?void 0:ge.length)??0)}})}}),(K=a["append-item"])==null?void 0:K.call(a)]}})]}),v.value.map((y,F)=>{function K(N){N.stopPropagation(),N.preventDefault(),i(y,!1)}const T={"onClick:close":K,onKeydown(N){N.key!=="Enter"&&N.key!==" "||(N.preventDefault(),N.stopPropagation(),K(N))},onMousedown(N){N.preventDefault(),N.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},B=se.value?!!a.chip:!!a.selection,q=B?ut(se.value?a.chip({item:y,index:F,props:T}):a.selection({item:y,index:F})):void 0;if(!(B&&!q))return s("div",{key:y.value,class:["v-autocomplete__selection",F===m.value&&["v-autocomplete__selection--selected",G.value]],style:F===m.value?L.value:{}},[se.value?a.chip?s(Me,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:y.title}}},{default:()=>[q]}):s(jt,te({key:"chip",closable:e.closableChips,size:"small",text:y.title,disabled:y.props.disabled},T),null):q??s("span",{class:"v-autocomplete__selection-text"},[y.title,e.multiple&&F<v.value.length-1&&s("span",{class:"v-autocomplete__selection-comma"},[de(",")])])])})]),"append-inner":function(){var T;for(var y=arguments.length,F=new Array(y),K=0;K<y;K++)F[K]=arguments[K];return s(H,null,[(T=a["append-inner"])==null?void 0:T.call(a,...F),e.menuIcon?s(De,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:X,onClick:it,"aria-label":r(U.value),title:r(U.value),tabindex:"-1"},null):void 0])}})}),Ut({isFocused:V,isPristine:_,menu:d,search:C,filteredItems:W,select:i},p)}}),tl=Object.assign({name:"AppAutocomplete",inheritAttrs:!1},{__name:"AppAutocomplete",setup(e){const x=R(()=>{const p=Oe().id,V=ct();return p?`app-autocomplete-${p}`:V}),a=R(()=>Oe().label);return(r,p)=>(D(),j("div",{class:vt(["app-autocomplete flex-grow-1",r.$attrs.class])},[h(a)?(D(),le(Et,{key:0,for:h(x),class:"mb-1 text-body-2",text:h(a)},null,8,["for","text"])):ze("",!0),s(el,Ke(Ne({...r.$attrs,class:null,label:void 0,id:h(x),variant:"outlined",menuProps:{contentClass:["app-inner-list","app-autocomplete__content","v-autocomplete__content"]}})),dt({_:2},[fe(r.$slots,(V,_)=>({name:_,fn:k(M=>[ft(r.$slots,_,Ke(Ne(M||{})))])}))]),1040)],2))}}),ll=$t("v-alert-title"),al=["success","info","warning","error"],nl=_e({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Pt,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>al.includes(e)},...qe(),...Ze(),...wt(),...St(),...Ct(),..._t(),...Vt(),...Ye(),...Xe(),...kt({variant:"flat"})},"VAlert"),ol=Ue()({name:"VAlert",props:nl(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,x){let{emit:a,slots:r}=x;const p=ke(e,"modelValue"),V=R(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),_=R(()=>({color:e.color??e.type,variant:e.variant})),{themeClasses:M}=Qe(e),{colorClasses:w,colorStyles:P,variantClasses:$}=mt(_),{densityClasses:d}=We(e),{dimensionStyles:m}=ht(e),{elevationClasses:A}=pt(e),{locationStyles:U}=gt(e),{positionClasses:S}=xt(e),{roundedClasses:O}=yt(e),{textColorClasses:f,textColorStyles:G}=tt(bt(e,"borderColor")),{t:L}=et(),C=R(()=>({"aria-label":L(e.closeLabel),onClick(v){p.value=!1,a("click:close",v)}}));return()=>{const v=!!(r.prepend||V.value),ne=!!(r.title||e.title),Q=!!(r.close||e.closable);return p.value&&s(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},M.value,w.value,d.value,A.value,S.value,O.value,$.value,e.class],style:[P.value,m.value,U.value,e.style],role:"alert"},{default:()=>{var W,oe;return[At(!1,"v-alert"),e.border&&s("div",{key:"border",class:["v-alert__border",f.value],style:G.value},null),v&&s("div",{key:"prepend",class:"v-alert__prepend"},[r.prepend?s(Me,{key:"prepend-defaults",disabled:!V.value,defaults:{VIcon:{density:e.density,icon:V.value,size:e.prominent?44:28}}},r.prepend):s(De,{key:"prepend-icon",density:e.density,icon:V.value,size:e.prominent?44:28},null)]),s("div",{class:"v-alert__content"},[ne&&s(ll,{key:"title"},{default:()=>{var z;return[((z=r.title)==null?void 0:z.call(r))??e.title]}}),((W=r.text)==null?void 0:W.call(r))??e.text,(oe=r.default)==null?void 0:oe.call(r)]),r.append&&s("div",{key:"append",class:"v-alert__append"},[r.append()]),Q&&s("div",{key:"close",class:"v-alert__close"},[r.close?s(Me,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var z;return[(z=r.close)==null?void 0:z.call(r,{props:C.value})]}}):s(ae,te({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},C.value),null)])]}})}}}),sl={class:"x-content"},il={class:"x-content-left"},ul={class:"x-content-left-top-1",style:{"margin-bottom":"16px"}},rl={class:"x-content-left-top-2"},cl={class:"x-content-left-bottom"},dl={class:"text-center px-0",style:{width:"40px",padding:"0!important"}},fl={class:"text-center px-0",style:{width:"40px"}},vl={class:"text-center px-0"},ml={class:"text-center px-0"},hl={class:"font-weight-bold",colspan:"2"},pl={class:"lines-ellipsis"},gl={class:"text-center px-0"},xl={class:"",colspan:"2"},yl={class:"lines-ellipsis"},bl={class:"text-right font-weight-bold",style:{"font-size":"16px"}},kl={class:"text-right",style:{"font-size":"16px"}},Vl={class:"text-right",style:{"font-size":"16px"}},_l={class:"text-center px-0",style:{width:"40px"}},Cl={class:""},Sl={class:"lines-ellipsis"},wl={class:"text-right font-weight-bold",style:{"font-size":"16px"}},Pl={class:"text-right",style:{"font-size":"16px"}},Al={class:"text-right",style:{"font-size":"16px"}},Fl={class:"x-content-right"},Il={class:"x-top-section"},Tl={class:"x-middle-section"},El={style:{"padding-left":"0!important"}},Dl={class:"lines-ellipsis"},Ml={class:"text-right",style:{"font-size":"16px"}},zl={class:"text-right"},Ul={class:"text-right",style:{"font-size":"16px"}},Bl={class:"text-center",style:{"padding-right":"0!important"}},Rl={class:"x-bottom-section"},Ll={class:"x-bottom-section-totals"},Ol={class:"text-right font-weight-bold",style:{"font-size":"18px",width:"100px"}},Kl={class:"text-right font-weight-bold",style:{"font-size":"18px"}},Nl={class:"text-right font-weight-bold",style:{"font-size":"18px"}},$l={class:"text-right font-weight-bold",style:{"font-size":"18px"}},jl={class:"x-bottom-section-buttons"},Hl={__name:"caja-pos",props:["recordId"],emits:["success"],setup(e,{expose:x,emit:a}){const r=a,p=g(!1);g();let V="caja_pos",_=g(!1),M=g(""),w=g({}),P=g({});g([]),g([]);let $=g([]);g("");let d=g(!1),m=g(!1),A=g(!1),U=g(""),S=g([]),O=g([]),f=g([]),G=g([]),L=g(""),C=g(1);g([]),g([]),g([]);let v=g(null),ne=g(null);ie(S,()=>{ve()},{deep:!0}),ie(()=>f,(o,t)=>{J()},{deep:!0});const Q=async()=>{await Ge.get(`/${V}/get_tablas`).then(o=>{$.value=o.data.tipo_documentos,S.value=o.data.productos,G.value=o.data.servicios})},W=()=>{w.value={},P.value={IdCajaAperturaCierre:null,SunatCodigoTipoDocumento:"03",ruc:null,razonSocial:null,total_gratuito:0,total_exonerado:0,total_inafecto:0,total:0}},oe=async()=>{W(),M.value="Venta",S.value=S.value,J()},z=()=>{console.log("changeExpandedAll"),m.value=!m.value,S.value.forEach(o=>{o.expanded=m.value})},se=(o,t)=>{let u=S.value.findIndex(b=>b.index===o.index);u>-1?S.value[u].check=!1:S.value.forEach(b=>{b.items.forEach(i=>{i.index===o.index&&(i.check=!1)})}),f.value.splice(t,1)},J=()=>{let o=0;f.value.forEach(t=>{o+=t.total}),P.value.total=o.toFixed(2)},Ce=()=>{console.log("changeBuscarProducto"),O.value=[];let o=U.value.trim().toLowerCase();o!==""&&S.value.forEach(t=>{t.items.length===0?t.nombre.toLowerCase().includes(o)&&O.value.push(t):t.items.forEach(u=>{u.items.length===0&&u.nombre.toLowerCase().includes(o)&&O.value.push(u)})})};function Y(o,t){o.check=t,o.indeterminate=!1,o.items&&o.items.length>0&&o.items.forEach(u=>Y(u,t))}function ue(o){if(o.items&&o.items.length>0){const t=o.items.length;let u=0,b=0;o.items.forEach(i=>{i.check&&u++,i.indeterminate&&b++}),u===t?(o.check=!0,o.indeterminate=!1):u===0&&b===0?(o.check=!1,o.indeterminate=!1):(o.check=!1,o.indeterminate=!0)}}function Z(o,t=null){if(console.log("onNodeChange"),o.items&&o.items.length>0&&Y(o,o.check),t&&ue(t),o.items.length===0)if(o.check)f.value.push(X(o));else{let u=f.value.findIndex(b=>b.index===o.index);u>-1&&f.value.splice(u,1)}else o.items.forEach(u=>{if(u.check)f.value.push(X(u));else{let b=f.value.findIndex(i=>i.index===u.index);b>-1&&f.value.splice(b,1)}})}function Se(){we(S.value,d.value),ve(),S.value.forEach(o=>{if(o.items.length===0)if(o.check)f.value.push(X(o));else{let t=f.value.findIndex(u=>u.index===o.index);t>-1&&f.value.splice(t,1)}else o.items.forEach(t=>{if(t.items.length===0)if(t.check)f.value.push(X(t));else{let u=f.value.findIndex(b=>b.index===t.index);u>-1&&f.value.splice(u,1)}else t.items.forEach(u=>{if(u.check)f.value.push(X(u));else{let b=f.value.findIndex(i=>i.index===u.index);b>-1&&f.value.splice(b,1)}})})})}function we(o,t){o.forEach(u=>{Y(u,t)})}function ve(){const o=S.value.length;let t=S.value.filter(u=>u.check).length;t===o?(d.value=!0,A.value=!1):t===0?(d.value=!1,A.value=!1):(d.value=!1,A.value=!0)}function X(o,t=new WeakMap){if(o===null||typeof o!="object")return o;if(t.has(o))return t.get(o);const u=Array.isArray(o)?[]:{};t.set(o,u);for(const b in o)Object.prototype.hasOwnProperty.call(o,b)&&(u[b]=X(o[b],t));return u}const me=()=>{let o=G.value.find(t=>t.IdProducto===L.value);if(o){let t=Number(C.value),u=Number(o.Precio),b=t*u;f.value.push({nombre:o.Nombre,precio_unitario:u,cantidad:t,total:b,tipo:"S"})}L.value="",C.value=1,Ve(()=>{var u;const t=(u=v.value)==null?void 0:u.querySelector("input");t&&(t.focus(),t.select())})},Pe=()=>{Ve(()=>{var t;const o=(t=ne.value)==null?void 0:t.querySelector("input");o&&(o.focus(),o.select())})},Ae=async()=>{_.value=!0,await Ge.post(`/${V}`,P.value).then(o=>{let t=o.data;t.success&&(r("success",t.data),he())}).catch(o=>{w.value=o}),_.value=!1},Fe=()=>{p.value=!0},he=()=>{p.value=!1};return x({openDialog:Fe}),Ft(async()=>{await Q()}),(o,t)=>{const u=Ht,b=tl;return D(),le(Gt,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=i=>p.value=i),fullscreen:"",scrim:!1,onAfterEnter:oe,transition:"dialog-bottom-transition"},{default:k(()=>[n("div",sl,[n("div",il,[n("div",ul,[s(Ie,{style:{height:"100%"}},{default:k(()=>[s(Te,null,{default:k(()=>[s(ye,null,{default:k(()=>[s(ee,{cols:"4",class:"py-0"},{default:k(()=>[s(u,{modelValue:h(P).numeroPaciente,"onUpdate:modelValue":t[0]||(t[0]=i=>h(P).numeroPaciente=i),label:"Número"},{append:k(()=>t[6]||(t[6]=[])),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),n("div",rl,[s(Ie,{style:{height:"100%"}},{default:k(()=>[s(Te,null,{default:k(()=>[s(ye,null,{default:k(()=>[s(ee,{cols:"12",class:"mb-2"},{default:k(()=>[s(u,{modelValue:h(U),"onUpdate:modelValue":t[1]||(t[1]=i=>xe(U)?U.value=i:U=i),label:"Buscar por nombre del producto",onInput:Ce},null,8,["modelValue"])]),_:1}),s(ee,{cols:"12",class:"py-0"},{default:k(()=>[n("div",cl,[h(O).length>0?(D(),le(be,{key:0,density:"comfortable"},{default:k(()=>[n("tbody",null,[(D(!0),j(H,null,fe(h(O),i=>(D(),j("tr",null,[n("td",null,[s(ce,{modelValue:i.check,"onUpdate:modelValue":l=>i.check=l,density:"compact",class:"x-checkbox"},null,8,["modelValue","onUpdate:modelValue"])]),n("td",null,E(i.nombre),1)]))),256))])]),_:1})):(D(),le(be,{key:1,density:"comfortable","fixed-header":""},{default:k(()=>[n("thead",null,[n("tr",null,[n("th",dl,[s(ae,{icon:`${h(m)?"tabler-chevron-down":"tabler-chevron-right"}`,variant:"text",color:"primary",onClick:z},null,8,["icon"])]),t[7]||(t[7]=n("th",{class:"text-center px-0",style:{width:"40px"}},null,-1)),n("th",fl,[s(ce,{modelValue:h(d),"onUpdate:modelValue":[t[2]||(t[2]=i=>xe(d)?d.value=i:d=i),Se],indeterminate:h(A),density:"compact",class:"x-checkbox"},null,8,["modelValue","indeterminate"])]),t[8]||(t[8]=n("th",{class:"text-left",colspan:"2"},"Nombre",-1)),t[9]||(t[9]=n("th",{class:"text-right"},"Cantidad",-1)),t[10]||(t[10]=n("th",{class:"text-right"},"P.Unitario",-1)),t[11]||(t[11]=n("th",{class:"text-right"},"Total",-1))])]),n("tbody",null,[(D(!0),j(H,null,fe(h(S),i=>(D(),j(H,{key:i.name},[n("tr",null,[t[15]||(t[15]=n("td",{class:"text-center px-0"},null,-1)),n("td",vl,[i.items.length>0?(D(),le(ae,{key:0,icon:`${i.expanded?"tabler-chevron-down":"tabler-chevron-right"}`,variant:"text",color:"primary",onClick:l=>i.expanded=!i.expanded},null,8,["icon","onClick"])):ze("",!0)]),i.items.length>0?(D(),j(H,{key:0},[n("td",ml,[s(ce,{modelValue:i.check,"onUpdate:modelValue":[l=>i.check=l,l=>Z(i)],density:"compact",class:"x-checkbox",indeterminate:i.indeterminate},null,8,["modelValue","onUpdate:modelValue","indeterminate"])]),n("td",hl,[n("div",pl,E(i.nombre),1)]),t[12]||(t[12]=n("td",null,null,-1)),t[13]||(t[13]=n("td",null,null,-1)),t[14]||(t[14]=n("td",null,null,-1))],64)):(D(),j(H,{key:1},[n("td",gl,[s(ce,{modelValue:i.check,"onUpdate:modelValue":[l=>i.check=l,l=>Z(i)],density:"compact",class:"x-checkbox"},null,8,["modelValue","onUpdate:modelValue"])]),n("td",xl,[n("div",yl,E(i.nombre),1)]),n("td",bl,E(i.cantidad),1),n("td",kl,E(i.precio_unitario),1),n("td",Vl,E(i.total),1)],64))]),i.expanded&&i.visible?(D(!0),j(H,{key:0},fe(i.items,l=>(D(),j("tr",{key:`row-${i.nombre}`},[t[16]||(t[16]=n("td",{class:"pa-0"},null,-1)),t[17]||(t[17]=n("td",{class:"pa-0"},null,-1)),t[18]||(t[18]=n("td",{class:""},null,-1)),n("td",_l,[s(ce,{modelValue:l.check,"onUpdate:modelValue":[c=>l.check=c,c=>Z(l,i)],density:"comfortable",class:"x-checkbox"},null,8,["modelValue","onUpdate:modelValue"])]),n("td",Cl,[n("div",Sl,E(l.nombre),1)]),n("td",wl,E(l.cantidad),1),n("td",Pl,E(l.precio_unitario),1),n("td",Al,E(l.total),1)]))),128)):ze("",!0)],64))),128))])]),_:1}))])]),_:1})]),_:1})]),_:1})]),_:1})])]),n("div",Fl,[s(Ie,{style:{height:"100%"}},{default:k(()=>[s(Te,null,{default:k(()=>[n("div",Il,[s(ye,null,{default:k(()=>[s(ee,null,{default:k(()=>[n("div",{ref_key:"nextSelect",ref:v},[s(b,{modelValue:h(L),"onUpdate:modelValue":t[3]||(t[3]=i=>xe(L)?L.value=i:L=i),label:"Servicio",items:h(G),"item-title":"Nombre","item-value":"IdProducto",placeholder:"Select State",onKeydown:$e(Pe,["enter"])},null,8,["modelValue","items"])],512)]),_:1}),s(ee,null,{default:k(()=>[n("div",{ref_key:"nextField",ref:ne},[s(u,{modelValue:h(C),"onUpdate:modelValue":t[4]||(t[4]=i=>xe(C)?C.value=i:C=i),label:"Cantidad",type:"number",onKeydown:$e(me,["enter"])},{append:k(()=>[s(ae,{onClick:me},{default:k(()=>t[19]||(t[19]=[de(" + Agregar ")])),_:1})]),_:1},8,["modelValue"])],512)]),_:1})]),_:1})]),n("div",Tl,[h(f).length>0?(D(),le(be,{key:0,density:"comfortable","fixed-header":""},{default:k(()=>[t[20]||(t[20]=n("thead",null,[n("tr",null,[n("th",{style:{"padding-left":"0!important"}},"Producto"),n("th",{class:"text-right"},"P.U."),n("th",{style:{width:"120px"}},"Cant."),n("th",{class:"text-right"},"Total"),n("th",{style:{"padding-right":"0!important"}})])],-1)),n("tbody",null,[(D(!0),j(H,null,fe(h(f),(i,l)=>(D(),j("tr",null,[n("td",El,[n("div",Dl,E(i.nombre),1)]),n("td",Ml,E(i.precio_unitario),1),n("td",zl,[s(u,{modelValue:i.cantidad,"onUpdate:modelValue":c=>i.cantidad=c,min:0,max:i.cantidad_inicial,type:"number"},null,8,["modelValue","onUpdate:modelValue","max"])]),n("td",Ul,E(i.total),1),n("td",Bl,[s(ae,{icon:"tabler-x",variant:"tonal",color:"error",onClick:c=>se(i,l)},null,8,["onClick"])])]))),256))])]),_:1})):(D(),le(ol,{key:1,color:"error",icon:"tabler-shopping-bag-exclamation",variant:"outlined"},{default:k(()=>t[21]||(t[21]=[de(" No cuenta con productos seleccinados. ")])),_:1}))]),n("div",Rl,[n("div",Ll,[s(be,{density:"compact"},{default:k(()=>[n("tbody",null,[n("tr",null,[t[22]||(t[22]=n("td",{class:"text-right font-weight-bold",style:{"font-size":"14px"}},"Total gratuito ",-1)),t[23]||(t[23]=n("td",{style:{width:"5px"}},":",-1)),n("td",Ol,E(h(P).total_gratuito),1)]),n("tr",null,[t[24]||(t[24]=n("td",{class:"text-right font-weight-bold",style:{"font-size":"14px"}},"Total exonerado ",-1)),t[25]||(t[25]=n("td",{style:{width:"5px"}},":",-1)),n("td",Kl,E(h(P).total_exonerado),1)]),n("tr",null,[t[26]||(t[26]=n("td",{class:"text-right font-weight-bold",style:{"font-size":"14px"}},"Total inafecto ",-1)),t[27]||(t[27]=n("td",{style:{width:"5px"}},":",-1)),n("td",Nl,E(h(P).total_inafecto),1)]),n("tr",null,[t[28]||(t[28]=n("td",{class:"text-right font-weight-bold",style:{"font-size":"14px"}},"Total",-1)),t[29]||(t[29]=n("td",{style:{width:"5px"}},":",-1)),n("td",$l,E(h(P).total),1)])])]),_:1})]),n("div",jl,[s(ye,null,{default:k(()=>[s(ee,{cols:"6"},{default:k(()=>[s(ae,{variant:"outlined",color:"secondary",size:"large",block:"",onClick:he,disabled:h(_),style:{"font-size":"16px!important"}},{default:k(()=>t[30]||(t[30]=[de(" Cancelar ")])),_:1},8,["disabled"])]),_:1}),s(ee,{cols:"6"},{default:k(()=>[s(ae,{class:"mr-1",color:"primary",size:"large",block:"",onClick:Ae,loading:h(_),disabled:h(_)||h(f).length===0,style:{"font-size":"16px!important"}},{default:k(()=>[de(" Pagar ("+E(h(f).length)+") ",1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})])])]),_:1})]),_:1})])])]),_:1},8,["modelValue"])}}},ra=Object.freeze(Object.defineProperty({__proto__:null,default:Hl},Symbol.toStringTag,{value:"Module"}));export{be as V,Hl as _,Jt as a,ra as c,Qt as m,Yt as u};
